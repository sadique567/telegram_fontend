<!DOCTYPE html>
<html>
  <head>
    <title>Telegram Login</title>
    <style>
      body {
        font-family: Arial, sans-serif;
        text-align: center;
        margin-top: 50px;
      }
      #userData {
        margin-top: 30px;
        padding: 20px;
        border: 1px solid #ccc;
        display: inline-block;
        text-align: left;
        background: #f0f0f0;
        border-radius: 10px;
      }
      img {
        border-radius: 50%;
      }
    </style>
  </head>
  <body>
    <h1>Login with Telegram</h1>

    <!-- Yahan data-origin add kiya â€“ yeh zaroori hai! -->
    <script
      async
      src="https://telegram.org/js/telegram-widget.js?22"
      data-telegram-login="flutter_login_bot"
      data-size="large"
      data-userpic="true"
      data-origin="https://telegram-fontend.vercel.app/"
      data-onauth="onTelegramAuth"
      ></script>
      <!-- data-onauth="onTelegramAuth(user)" -->

    <div id="userData"></div>

    <script type="text/javascript">
      function onTelegramAuth(user) {
        console.log("Telegram se data mila:", user); // Console check karo

        let html = `<h2>ðŸŽ‰ Login Successful!</h2>`;
        html += `<p><strong>ID:</strong> ${user.id}</p>`;
        html += `<p><strong>First Name:</strong> ${user.first_name}</p>`;
        if (user.last_name)
          html += `<p><strong>Last Name:</strong> ${user.last_name}</p>`;
        if (user.username)
          html += `<p><strong>Username:</strong> @${user.username}</p>`;
        if (user.photo_url)
          html += `<p><img src="${user.photo_url}" width="150" height="150" alt="Profile Photo"></p>`;
        html += `<p><strong>Auth Date:</strong> ${new Date(
          user.auth_date * 1000
        ).toLocaleString()}</p>`;
        // Hash mat dikhao security ke liye, lekin test ke liye rakh sakte ho
        // html += `<p><strong>Hash:</strong> ${user.hash}</p>`;

        document.getElementById("userData").innerHTML = html;

        // Flutter WebView ke liye redirect
        const redirectUrl =
          "flutter://login-success?user=" +
          encodeURIComponent(JSON.stringify(user));
        console.log("Redirecting to:", redirectUrl);
        window.location.href = redirectUrl;
      }
    </script>
  </body>
</html>
