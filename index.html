<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Telegram Login</title>

  <style>
    body {
      font-family: "Segoe UI", Arial, sans-serif;
      background: #eef2f7;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }

    .card {
      background: #fff;
      width: 360px;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 10px 30px rgba(0,0,0,0.1);
      text-align: center;
    }

    .profile-img {
      width: 100px;
      height: 100px;
      border-radius: 50%;
      object-fit: cover;
      margin-bottom: 15px;
      border: 3px solid #0088cc;
    }

    h2 {
      margin-bottom: 20px;
      color: #333;
    }

    .info {
      text-align: left;
      margin-top: 15px;
    }

    .info div {
      margin-bottom: 8px;
      font-size: 14px;
      color: #444;
    }

    .label {
      font-weight: 600;
      color: #666;
    }

    .login-btn {
      margin-top: 15px;
    }

    .success {
      color: #2e7d32;
      font-weight: 600;
      margin-top: 10px;
    }
  </style>
</head>

<body>

  <div class="card">
    <h2>Telegram Login</h2>

    <!-- Profile -->
    <img id="profilePic" class="profile-img" style="display:none;" />

    <!-- User Info -->
    <div id="userInfo" class="info" style="display:none;">
      <div><span class="label">ID:</span> <span id="uid"></span></div>
      <div><span class="label">First Name:</span> <span id="fname"></span></div>
      <div><span class="label">Last Name:</span> <span id="lname"></span></div>
      <div><span class="label">Username:</span> <span id="username"></span></div>
      <div><span class="label">Login Time:</span> <span id="loginTime"></span></div>
    </div>

    <div id="status" class="success"></div>

    <!-- Telegram Widget -->
    <div class="login-btn">
      <script
        src="https://telegram.org/js/telegram-widget.js?22"
        data-telegram-login="flutter_login_bot"
        data-size="large"
        data-onauth="onTelegramAuth(user)"
        data-request-access="write">
      </script>
    </div>
  </div>

  <script>
    function onTelegramAuth(user) {
      console.log("Telegram User:", user);

      // UI fill
      document.getElementById("profilePic").src = user.photo_url || "";
      document.getElementById("profilePic").style.display = "block";

      document.getElementById("uid").innerText = user.id;
      document.getElementById("fname").innerText = user.first_name;
      document.getElementById("lname").innerText = user.last_name || "-";
      document.getElementById("username").innerText = user.username
        ? "@" + user.username
        : "-";

      document.getElementById("loginTime").innerText =
        new Date(user.auth_date * 1000).toLocaleString();

      document.getElementById("userInfo").style.display = "block";
      document.getElementById("status").innerText = "Login successful âœ”";

      // Send to backend
      fetch("https://telegram1auth.onrender.com/auth/telegram", {
        method: "POST",
        credentials: "include",
        headers: {
          "Content-Type": "application/json",
        },
        body: JSON.stringify(user),
      });
    }
  </script>

</body>
</html>
